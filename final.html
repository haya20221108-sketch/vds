<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>H1E è¬è§£ã - ã‚²ãƒ¼ãƒ ã‚¯ãƒªã‚¢</title>
    <link rel="stylesheet" href="styles.css" />
    <style>
      /* ãƒšãƒ¼ã‚¸å†…ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’èª¿æ•´ï¼ˆã‚‚ã—å¿…è¦ã§ã‚ã‚Œã°ï¼‰ */
      .container {
        text-align: center;
        max-width: 600px;
        margin: 30px auto;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      #result-area {
        background-color: #e8f5e9; /* è–„ã„ç·‘è‰² */
      }
      .hidden {
        display: none;
      }
      #end-game-button {
        background-color: #00796b;
        color: white;
        padding: 10px 20px;
        font-size: 1.2em;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <header><p id="user-info">[ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ]ã•ã‚“ã®ã‚²ãƒ¼ãƒ ã‚¯ãƒªã‚¢</p></header>

    <main>
      <h1>ğŸ‰ è¬è§£ãã‚¯ãƒªã‚¢ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ ğŸ‰</h1>
      <p>
        ã™ã¹ã¦ã®è¬ã‚’è§£ãçµ‚ãˆã¾ã—ãŸã€‚æœ€å¾Œã«ã€Œçµæœè¡¨ç¤ºã¨ãƒªã‚»ãƒƒãƒˆã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã€æ™¯å“äº¤æ›ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã—ã€ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦ãã ã•ã„ã€‚
      </p>

      <div class="container">
        <button id="end-game-button">çµæœè¡¨ç¤ºã¨ãƒªã‚»ãƒƒãƒˆ</button>

        <p id="status-message" style="margin-top: 20px; font-weight: bold"></p>

        <div
          id="result-area"
          class="hidden"
          style="
            margin-top: 30px;
            border: 2px solid #00796b;
            padding: 15px;
            border-radius: 8px;
          "
        >
          <h2>è¡¨ç¤ºå®Œäº†ï¼</h2>
          <p>æ™¯å“äº¤æ›ç”¨ã‚³ãƒ¼ãƒ‰ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ç”Ÿæˆï¼‰ï¼š</p>
          <div
            style="
              font-size: 1.5em;
              font-weight: bold;
              color: #d32f2f;
              margin: 10px 0;
            "
          >
            <span id="display-code">CODE-TEST</span>
          </div>
          <p>
            ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ã‚¿ãƒƒãƒ•ã«æç¤ºã—ã¦ãã ã•ã„ã€‚ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼
          </p>
          <button
            onclick="window.location.href='index.html';"
            style="margin-top: 15px"
          >
            æœ€åˆã«æˆ»ã‚‹
          </button>
        </div>
      </div>
    </main>
  </body>
</html>
<script>
  const statusElements = {
    message: document.getElementById("status-message"),
    displayCode: document.getElementById("display-code"),
    resultArea: document.getElementById("result-area"),
    endButton: document.getElementById("end-game-button"),
  };
  let currentNickname = "";

  // ğŸš¨ ä¿®æ­£ç‚¹1: ãƒ©ãƒ³ãƒ€ãƒ ã«é¸ã¶æ™¯å“äº¤æ›ç”¨ã‚³ãƒ¼ãƒ‰ã®ãƒªã‚¹ãƒˆ ğŸš¨
  const PRIZE_CODES = [
    "7381592406",
    "2946017385",
    "5072381964",
    "1635940827",
    // å¿…è¦ã«å¿œã˜ã¦ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚
    // ä¾‹: "H1E-CODE-007", "H1E-CODE-008" ãªã©
  ];
  let finalPrizeCode = ""; // ãƒ©ãƒ³ãƒ€ãƒ ã«é¸ã°ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã‚’æ ¼ç´

  window.onload = function () {
    currentNickname = sessionStorage.getItem("currentNickname");

    if (!currentNickname) {
      // ã‚¨ãƒ©ãƒ¼ã®å ´åˆã€è‡ªå‹•çš„ã«ç™»éŒ²ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
      alert("ã‚¨ãƒ©ãƒ¼: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãŒç¢ºèªã§ãã¾ã›ã‚“ã€‚ç™»éŒ²ãƒšãƒ¼ã‚¸ã«æˆ»ã‚Šã¾ã™ã€‚");
      window.location.href = "index.html";
      return;
    }

    document.getElementById(
      "user-info"
    ).textContent = `${currentNickname}ã•ã‚“ã®ã‚²ãƒ¼ãƒ ã‚¯ãƒªã‚¢`;

    // ğŸš¨ ä¿®æ­£ç‚¹2: ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«ãƒ©ãƒ³ãƒ€ãƒ ã‚³ãƒ¼ãƒ‰ã‚’æ±ºå®š ğŸš¨
    const randomIndex = Math.floor(Math.random() * PRIZE_CODES.length);
    finalPrizeCode = PRIZE_CODES[randomIndex];

    // ãƒ‡ãƒãƒƒã‚°ç”¨: ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ç¢ºèª
    console.log(`å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸæ™¯å“ã‚³ãƒ¼ãƒ‰: ${finalPrizeCode}`);

    statusElements.endButton.addEventListener("click", showResultAndReset);
  };

  /**
   * çµæœã‚’è¡¨ç¤ºã—ã€ãƒ­ãƒ¼ã‚«ãƒ«/ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’å…¨ã¦ã‚¯ãƒªã‚¢ã™ã‚‹é–¢æ•°ã€‚
   */
  function showResultAndReset() {
    // ãƒœã‚¿ãƒ³ã®å¤šé‡ã‚¯ãƒªãƒƒã‚¯é˜²æ­¢
    statusElements.endButton.disabled = true;
    statusElements.message.style.color = "gray";
    statusElements.message.textContent = "çµæœã‚’é›†è¨ˆä¸­...";

    // 1. çµæœè¡¨ç¤º
    // ğŸš¨ ä¿®æ­£ç‚¹3: ãƒ©ãƒ³ãƒ€ãƒ ã«é¸ã°ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤º ğŸš¨
    statusElements.displayCode.textContent = finalPrizeCode;

    statusElements.resultArea.classList.remove("hidden");
    statusElements.message.style.color = "green";
    statusElements.message.innerHTML = `é›†è¨ˆå®Œäº†ï¼æ™¯å“äº¤æ›ã‚³ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚`;

    // 2. ğŸš¨ ãƒ‡ãƒ¼ã‚¿ã®å®Œå…¨ãƒªã‚»ãƒƒãƒˆ ğŸš¨
    // localStorage: è¬ã®ã‚¯ãƒªã‚¢çŠ¶æ³ ('h1e_achievements') ã‚’ã‚¯ãƒªã‚¢
    localStorage.clear();
    // sessionStorage: ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã€å„è¬ã®ç­”ãˆã€æœ€çµ‚ã‚³ãƒ¼ãƒ‰ã‚’ã‚¯ãƒªã‚¢
    sessionStorage.clear();
  }
</script>
